{"version":3,"sources":["webpack:///./src/pages/photography.js"],"names":["StyledSection","require","styled","section","Picture","key","value","getUrl","url","replaceAll","name","this","date","split","width","parseInt","height","fromFirestore","a","list","firebase","firestore","collection","doc","get","then","response","map","data","photos","Object","entries","push","PhotographyPage","useState","isLoading","setIsLoading","fetching","setFetching","setData","useEffect","auth","signInAnonymously","console","log","tmp","currentUser","delete","isEmpty","fetchData","animateNav","isHome","footer","rel","href"],"mappings":"6PAgBMA,G,UALIC,EAAQ,QAKIC,IAAOC,QAAV,iFAAGD,CAAH,yCAKbE,EACJ,SAAYC,EAAKC,GAAQ,IAAD,YAOxBC,OAAS,iBAASC,qFAAcC,YAAW,EAAKC,KAAM,IAAK,OAAzCF,yDANhBG,KAAKC,KAAOP,EACZM,KAAKD,KAAOJ,EAAMO,MAAM,KAAK,GAC7BF,KAAKG,MAAQC,SAAST,EAAMO,MAAM,KAAK,IACvCF,KAAKK,OAASD,SAAST,EAAMO,MAAM,KAAK,KAMtCI,EAAa,uCAAG,4BAAAC,EAAA,6DAChBC,EAAO,GADS,SAGdC,IAASC,YACdC,WAAW,SACXC,IAAI,OACJC,MAAMC,MAAK,SAAAC,GAGR,IAFA,IACMC,EADOD,EAASE,OACLC,OACjB,MAA0BC,OAAOC,QAAQJ,GAAzC,eAA+C,CAAC,IAAD,OAApCtB,EAAoC,KAA/BC,EAA+B,KAC7Ca,EAAKa,KAAK,IAAI5B,EAAQC,EAAKC,QAVb,gCAcba,GAda,2CAAH,qDAqEJc,UApDS,WAAO,IAAD,EAEMC,oBAAS,GAApCC,EAFqB,KAEVC,EAFU,OAGIF,oBAAS,GAAlCG,EAHqB,KAGXC,EAHW,OAIJJ,mBAAS,IAA1BN,EAJqB,KAIfW,EAJe,KAiC5B,OA1BAC,qBAAU,WAAM,4CAEd,4BAAAtB,EAAA,+EAEUE,IAASqB,OAAOC,oBAF1B,cAGIC,QAAQC,IAAI,aAHhB,SAIoB3B,IAJpB,OAIQ4B,EAJR,OAKIN,EAAQM,GACRT,GAAa,GACbhB,IAASqB,OAAOK,YAAYC,SAAStB,MAAK,WACxCkB,QAAQC,IAAI,gCARlB,kDAWID,QAAQC,IAAR,MACAR,GAAa,GAZjB,2DAFc,sBAkBXY,YAAQpB,IAASO,IAAcE,IAChCC,GAAY,GAnBC,WAAD,wBAoBZW,MAGD,CAACd,EAAWE,EAAUT,IAIvB,kBAAC,IAAD,CAAQsB,YAAY,EAAOC,QAAQ,EAAOC,QAAQ,GAChD,kBAAC,IAAD,KACE,6DACA,0BAAMC,IAAI,YAAYC,KAAK,0CAG7B,kBAACtD,EAAD,MACImC,GACA,kBAAC,IAAD,CAAWP,KAAMA,UAAQ,KAE1BO,GACC,kBAAC,IAAD","file":"component---src-pages-photography-js-70f131dff96081ba71f2.js","sourcesContent":["import React, { useEffect, useState }  from 'react';\r\nimport firebase from \"gatsby-plugin-firebase\";\r\nimport styled from 'styled-components';\r\nimport { Helmet } from 'react-helmet';\r\nimport { graphql } from 'gatsby';\r\nimport PropTypes from 'prop-types';\r\nimport { isEmpty, replaceAll } from \"@utils\";\r\nimport { Layout } from '@components';\r\nimport { LoadingPage, TilesPage } from '@components/photography';\r\nimport { media, mixins, Heading, Section } from '@styles';\r\n\r\nconst _ = require('lodash');\r\n\r\nconst url = \"https://firebasestorage.googleapis.com/v0/b/portfolio-49b69.appspot.com/o/\";\r\nconst token = \"ea925040-1fca-4eda-b1e8-0eb96567ab7e\";\r\n\r\nconst StyledSection = styled.section`\r\n  margin: auto 0;\r\n  padding: 100px 0 0px;\r\n`;\r\n\r\nclass Picture {\r\n  constructor(key, value) {\r\n    this.date = key;\r\n    this.name = value.split('\"')[1];\r\n    this.width = parseInt(value.split(\",\")[1]);\r\n    this.height = parseInt(value.split(\",\")[2]);\r\n  }\r\n\r\n  getUrl = () => `${url}photo%2F${replaceAll(this.name, ' ', '%20')}?alt=media&token=${token}`;\r\n}\r\n\r\nconst fromFirestore = async () => {\r\n  var list = [];\r\n\r\n  await firebase.firestore()\r\n  .collection(\"photo\")\r\n  .doc(\"all\")\r\n  .get().then(response => {\r\n      const data = response.data();\r\n      const map = data.photos;\r\n      for(const [key, value] of Object.entries(map)) {\r\n        list.push(new Picture(key, value));\r\n      }\r\n  });\r\n\r\n  return list;\r\n}\r\n\r\nconst PhotographyPage = () => {\r\n\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [fetching, setFetching] = useState(false);\r\n  const [data, setData] = useState({});\r\n\r\n\r\n  useEffect(() => {\r\n\r\n    async function fetchData() {\r\n      try {\r\n        await firebase.auth().signInAnonymously()\r\n        console.log(\"signed in\");\r\n        let tmp = await fromFirestore();\r\n        setData(tmp);\r\n        setIsLoading(false);\r\n        firebase.auth().currentUser.delete().then(() => {\r\n          console.log('anonymous account deleted');\r\n        });\r\n      } catch(e) {\r\n        console.log(e);\r\n        setIsLoading(false);\r\n      }\r\n    }\r\n\r\n    if(isEmpty(data) && isLoading && !fetching) {\r\n      setFetching(true);\r\n      fetchData();\r\n    }\r\n\r\n  }, [isLoading, fetching, data]);\r\n\r\n\r\n  return (\r\n    <Layout animateNav={false} isHome={false} footer={true}>\r\n      <Helmet>\r\n        <title>Photography | Howard Tseng</title>\r\n        <link rel=\"canonical\" href=\"https://howardt12345.com/photography\" />\r\n      </Helmet>\r\n\r\n      <StyledSection>\r\n        {!isLoading && (\r\n          <TilesPage data={data ?? []} />\r\n        )}\r\n        {isLoading && (\r\n          <LoadingPage />\r\n        )}\r\n      </StyledSection>\r\n    </Layout>\r\n  );\r\n}\r\n\r\nexport default PhotographyPage;"],"sourceRoot":""}